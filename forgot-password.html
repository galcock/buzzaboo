<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reset Password | Buzzaboo</title>
  <meta name="description" content="Reset your Buzzaboo password">
  
  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon-32x32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icons/apple-touch-icon.png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#8B5CF6">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="css/auth.css">
</head>
<body data-page="forgot-password" class="auth-page">
  <!-- Animated Background -->
  <div class="auth-bg">
    <div class="auth-bg-gradient"></div>
    <div class="auth-bg-grid"></div>
    <div class="auth-bg-orb auth-bg-orb-1"></div>
    <div class="auth-bg-orb auth-bg-orb-2"></div>
    <div class="auth-bg-orb auth-bg-orb-3"></div>
  </div>

  <!-- Main Content -->
  <main class="auth-container">
    <!-- Logo -->
    <a href="index.html" class="auth-logo">
      <span class="logo-icon">üêù</span>
      <span>Buzzaboo</span>
    </a>

    <!-- Auth Card -->
    <div class="auth-card glass-card">
      <!-- Default View -->
      <div id="resetView">
        <div class="auth-header">
          <div class="auth-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>
          </div>
          <h1 class="auth-title">Reset your password</h1>
          <p class="auth-subtitle">Enter your email address and we'll send you a link to reset your password</p>
        </div>

        <!-- Error Messages -->
        <div class="auth-message auth-message-error" id="errorMessage" style="display: none;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
          <span id="errorText">An error occurred</span>
        </div>

        <!-- Reset Form -->
        <form id="resetForm" class="auth-form">
          <div class="form-group">
            <label for="email" class="form-label">Email</label>
            <div class="input-wrapper">
              <svg class="input-icon" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
              <input type="email" id="email" name="email" class="form-input" placeholder="your@email.com" required autocomplete="email">
            </div>
          </div>

          <button type="submit" class="btn btn-primary btn-lg btn-block" id="resetBtn">
            <span class="btn-text">Send Reset Link</span>
            <span class="btn-loader" style="display: none;">
              <svg class="spinner" width="20" height="20" viewBox="0 0 24 24"><circle class="spinner-track" cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="3" opacity="0.3"/><path class="spinner-head" d="M12 2a10 10 0 0 1 10 10" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"/></svg>
            </span>
          </button>
        </form>

        <div class="auth-footer">
          <p><a href="login.html" class="auth-link">‚Üê Back to login</a></p>
        </div>
      </div>

      <!-- Success View -->
      <div id="successView" style="display: none;">
        <div class="auth-header">
          <div class="auth-icon success">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
          </div>
          <h1 class="auth-title">Check your email</h1>
          <p class="auth-subtitle" id="successEmail">We've sent a password reset link to your email address</p>
        </div>

        <div class="auth-info-box">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
          <div>
            <p><strong>Didn't receive the email?</strong></p>
            <p>Check your spam folder or <button type="button" class="btn-link" id="resendBtn">click here to resend</button></p>
          </div>
        </div>

        <div class="auth-footer">
          <a href="login.html" class="btn btn-secondary btn-block">‚Üê Back to login</a>
        </div>
      </div>
    </div>

    <!-- Terms -->
    <p class="auth-terms">
      <a href="#">Help Center</a> ‚Ä¢ <a href="#">Privacy</a> ‚Ä¢ <a href="#">Terms</a>
    </p>
  </main>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  
  <!-- Auth Scripts -->
  <script src="js/firebase-config.js"></script>
  <script src="js/auth-service.js"></script>
  
  <script>
    let submittedEmail = '';

    document.addEventListener('DOMContentLoaded', () => {
      const resetForm = document.getElementById('resetForm');
      
      resetForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('email').value;
        submittedEmail = email;
        
        setLoading(true);
        hideError();

        const result = await buzzabooAuth.sendPasswordReset(email);
        
        setLoading(false);

        if (result.success) {
          showSuccessView(email);
        } else {
          showError(result.error);
        }
      });

      // Resend button
      document.getElementById('resendBtn').addEventListener('click', async () => {
        if (!submittedEmail) return;
        
        const result = await buzzabooAuth.sendPasswordReset(submittedEmail);
        
        if (result.success) {
          alert('Reset link sent again!');
        } else {
          alert(result.error);
        }
      });
    });

    function setLoading(loading) {
      const resetBtn = document.getElementById('resetBtn');
      resetBtn.disabled = loading;
      resetBtn.querySelector('.btn-text').style.display = loading ? 'none' : 'inline';
      resetBtn.querySelector('.btn-loader').style.display = loading ? 'inline-flex' : 'none';
    }

    function showError(message) {
      const errorEl = document.getElementById('errorMessage');
      document.getElementById('errorText').textContent = message;
      errorEl.style.display = 'flex';
    }

    function hideError() {
      document.getElementById('errorMessage').style.display = 'none';
    }

    function showSuccessView(email) {
      document.getElementById('resetView').style.display = 'none';
      document.getElementById('successView').style.display = 'block';
      document.getElementById('successEmail').textContent = `We've sent a password reset link to ${email}`;
    }
  </script>
</body>
</html>
